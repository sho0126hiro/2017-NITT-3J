/***  mp3ex07.txt  ***/
/***  s16306  3J43  廣瀬 翔  ***/

1．課題
	「ledpwm.c」を参考にして，ＬＥＤ１をＰＷＭ駆動する。
	PWM周期を10msecに「保ったまま，４秒ごとに，デューティ比を２％，４％，８％，１６％，３２％，６４％と
	変化させるプログムを作りなさい。
	実行の様子を観察し，その様子を実行結果として報告しなさい。
	ヒント:次の関数の使用を検討する
	void wait_m4sec(int m4_sec)
	/*10^-4secで指示する間なにもしない時間稼ぎ関数*/
	/*たとえばwait_m4sec(15);を呼ぶと1.5msec後にこの関数から戻る*/
	{
		int i,j;
		for (i=0;i<m4_sec;i++) {
		for (j=0;j<419;j++); /*419の根拠を考えてみよう*/
		}
	}

	
2．使用したプログラム
	#include <3048fone.h>
	#include "h8_3048fone.h"

	void wait_m4sec(int m4_sec)
	/*10^-4secで指示する間なにもしない時間稼ぎ関数*/
	/*たとえばwait_m4sec(15);を呼ぶと1.5msec後にこの関数から戻る*/
	{
		int i,j;
		for (i=0;i<m4_sec;i++) {
			for (j=0;j<419;j++); /*419の根拠を考えてみよう*/
		}
	}

	main()
	{
		int i=2,j;
		initLed();
		while(1) {
			turnOnLed(0); /*LED0のON*/
			for(j=0;j<400;j++){
				/*デューティー比2^i%*/
				turnOnLed(1); /*LED1のON*/
				wait_m4sec(i);
				turnOffLed(1); /*LED1のOFF*/
				wait_m4sec(100-i);
			}
			if(i==64)i=2;
			else i=i*2;
		}
	}

3．実行結果
	
	LED0:常時点灯
	LED1:4秒ごとに明るさが切り替わる．
	（だんだん明るくなり，明るさの最大値（デューティー比64%)に達してから4秒後，再び暗く点灯する（デューティー比2%）
	
4．考察

	wait_m4sec内の419について
	for (j=0;j<419;j++); /*419の根拠を考えてみよう*/
	
	実測1秒はfor(j=0;j<4190;j++);であるので，このループが終わるには0.1秒かかることがわかる．
	よってwait_m4sec(15);を呼ぶと1.5msec後にこの関数から戻る．
	
5．まとめ
	LEDの周期の変化によって，LEDの明るさを変えることができるということを理解した．
